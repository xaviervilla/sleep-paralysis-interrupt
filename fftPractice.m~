close all
clear variables
clc  

% A common use of Fourier transforms is to find the frequency components 
% of a signal buried in a noisy time domain signal. Consider data sampled 
% at 1000 Hz. Form a signal containing 50 Hz and 120 Hz and corrupt it 
% with some zero-mean random noise:

% Sensor Data:
accel = csvread('alfonso.csv');
% Number of samples:
numSamples = 64;
% Number of seconds:
numSeconds = 2;

%%%%%%%%%%%%%%% No need to modify anything below this line %%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
sampleFreq = numSamples/numSeconds;

t = (0:numSamples-1)/sampleFreq;
x = accel(139:202, 1).';
x=x-mean(x);
y = x;

figure
plot(t,y)
title('Signal Corrupted with Zero-Mean Random Noise')
xlabel('time (seconds)')
hold off

% It is difficult to identify the frequency components by looking at the 
% original signal. Converting to the frequency domain, the discrete 
% Fourier transform of the noisy signal y is found by taking the 512-point 
% fast Fourier transform (FFT):
Y = fft(y,64);

% The power spectrum, a measurement of the power at various frequencies:
Pyy = Y.* conj(Y) / 64;

% Graph the first 257 points (the other 255 points are redundant) on a 
% meaningful frequency axis:
figure
f = 16*(1:sampleFreq*numSeconds)/(sampleFreq*2);
[pks,locs,widths,proms] = findpeaks(Pyy);
%test = f(locs)
plot(f(1:32),Pyy(1:64))
hold on
plot(f(locs(1:3)),pks(1:3),'or')
title('Frequency content of y')
xlabel('frequency (Hz)')

